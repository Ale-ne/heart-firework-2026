<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>é«˜çº§æ„Ÿå¿ƒè·³çˆ±å¿ƒ | çƒŸèŠ±ç‚¸è£‚ç‰¹æ•ˆï¼ˆå¸¦éŸ³æ•ˆï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: "Microsoft Yahei", sans-serif;
            /* é«˜çº§æš—è°ƒæ¸å˜èƒŒæ™¯ */
            background: linear-gradient(135deg, #0a0a12, #120f24, #0f0a1e);
        }
        canvas {
            display: block;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 0;
        }
        .tip {
            position: absolute;
            bottom: 30px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
            z-index: 1;
            transition: opacity 0.5s;
            text-shadow: 0 0 10px rgba(180, 100, 160, 0.5);
        }
        .tip:hover {
            opacity: 1;
            color: rgba(255, 255, 255, 0.9);
        }
        /* éšè—éŸ³é¢‘æ§ä»¶ä½†ä¿ç•™éŸ³æ•ˆ */
        audio {
            display: none;
        }
    </style>
</head>
<body>
    <canvas id="heartCanvas"></canvas>
    <div class="tip">ğŸ’« é¼ æ ‡ç§»åŠ¨äº’åŠ¨ | å¿ƒè·³è§¦å‘å…¨å±çƒŸèŠ±+éŸ³æ•ˆ ğŸ’«</div>
    
    <!-- éŸ³æ•ˆèµ„æºï¼ˆä½¿ç”¨å…è´¹å…¬å…±CDNèµ„æºï¼Œæ— éœ€æœ¬åœ°ä¸‹è½½ï¼‰ -->
    <audio id="heartbeatAudio" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/05/26/audio_1f20809982.mp3?filename=heartbeat-120881.mp3" type="audio/mpeg">
    </audio>
    <audio id="fireworkAudio">
        <source src="https://cdn.pixabay.com/download/audio/2022/03/08/audio_299f59929f.mp3?filename=firework-83202.mp3" type="audio/mpeg">
    </audio>

    <script>
        const canvas = document.getElementById('heartCanvas');
        const ctx = canvas.getContext('2d');
        let canvasWidth = window.innerWidth;
        let canvasHeight = window.innerHeight;
        canvas.width = canvasWidth;
        canvas.height = canvasHeight;

        // éŸ³æ•ˆåˆå§‹åŒ–
        const heartbeatAudio = document.getElementById('heartbeatAudio');
        const fireworkAudio = document.getElementById('fireworkAudio');
        // è®¾ç½®éŸ³æ•ˆéŸ³é‡ï¼ˆé¿å…è¿‡å“ï¼‰
        heartbeatAudio.volume = 0.5;
        fireworkAudio.volume = 0.7;
        // è‡ªåŠ¨æ’­æ”¾å¿ƒè·³å£°ï¼ˆéœ€ç”¨æˆ·äº¤äº’åè§¦å‘ï¼Œç¬¦åˆæµè§ˆå™¨ç­–ç•¥ï¼‰
        document.addEventListener('click', () => {
            if (heartbeatAudio.paused) {
                heartbeatAudio.play().catch(err => console.log("éŸ³æ•ˆæ’­æ”¾éœ€ç”¨æˆ·äº¤äº’ï¼š", err));
            }
        });

        // é€‚é…çª—å£
        window.addEventListener('resize', () => {
            canvasWidth = window.innerWidth;
            canvasHeight = window.innerHeight;
            canvas.width = canvasWidth;
            canvas.height = canvasHeight;
            // é‡ç½®æ˜Ÿç©ºç²’å­
            starParticles = createStarParticles();
        });

        // å…¨å±€é…ç½®
        const config = {
            heart: { baseScale: 1, pulseSpeed: 0.04, maxScale: 1.15 },
            colors: {
                // é«˜çº§è«å…°è¿ªç«ç‘°è‰²ç³»ï¼ˆä¸»è‰²ï¼‰
                primary: '#9f4e78',
                secondary: '#7a3b69',
                tertiary: '#b86a8f',
                // çƒŸèŠ±è¾…åŠ©è‰²
                firework: ['#d88a9e', '#a25a7a', '#e2a4b4', '#6b3452', '#c0708f'],
                // æ˜Ÿç©ºç²’å­è‰²
                star: '#e8c4cd'
            },
            particles: { maxCount: 1200 }, // æé«˜ç²’å­ä¸Šé™
            fireworks: { maxCount: 50 }    // æé«˜çƒŸèŠ±ä¸Šé™
        };

        // 1. æ˜Ÿç©ºç²’å­ï¼ˆæ‰“åº•ï¼Œé¿å…èƒŒæ™¯ç©ºæ—·ï¼‰
        let starParticles = [];
        class StarParticle {
            constructor() {
                this.x = Math.random() * canvasWidth;
                this.y = Math.random() * canvasHeight;
                this.size = Math.random() * 1.2 + 0.2;
                this.alpha = Math.random() * 0.7 + 0.1;
                this.speed = Math.random() * 0.2 + 0.05;
                this.angle = Math.random() * Math.PI * 2;
            }
            update() {
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed;
                // è¾¹ç•Œå›å¼¹
                if (this.x < 0) this.x = canvasWidth;
                if (this.x > canvasWidth) this.x = 0;
                if (this.y < 0) this.y = canvasHeight;
                if (this.y > canvasHeight) this.y = 0;
                // å‘¼å¸æ•ˆæœ
                this.alpha += Math.sin(Date.now() / 2000) * 0.005;
                this.alpha = Math.max(0.1, Math.min(0.8, this.alpha));
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(${parseInt(config.colors.star.slice(1,3),16)}, ${parseInt(config.colors.star.slice(3,5),16)}, ${parseInt(config.colors.star.slice(5,7),16)}, ${this.alpha})`;
                ctx.fill();
            }
        }
        // åˆ›å»ºæ˜Ÿç©ºç²’å­
        function createStarParticles() {
            const stars = [];
            for (let i = 0; i < 300; i++) stars.push(new StarParticle()); // å¢åŠ æ˜Ÿç©ºç²’å­æ•°é‡
            return stars;
        }
        starParticles = createStarParticles();

        // 2. çƒŸèŠ±ç²’å­ï¼ˆæ ¸å¿ƒéœ‡æ’¼æ•ˆæœ - æé«˜å¯†åº¦ï¼‰
        let fireworkParticles = [];
        class FireworkParticle {
            constructor(x, y, type = 'normal') {
                this.x = x;
                this.y = y;
                this.type = type; // normal:æ™®é€šç²’å­, trail:æ‹–å°¾, core:çƒŸèŠ±æ ¸å¿ƒ
                // æ ¸å¿ƒç²’å­æ›´å¤§æ›´äº®
                this.size = type === 'core' ? Math.random() * 6 + 4 : (type === 'trail' ? Math.random() * 2 + 0.5 : Math.random() * 3 + 1);
                // éšæœºé€‰æ‹©é«˜çº§é…è‰²
                this.color = config.colors.firework[Math.floor(Math.random() * config.colors.firework.length)];
                // é€Ÿåº¦å’Œè§’åº¦ï¼ˆç‚¸è£‚æ•ˆæœï¼‰
                this.angle = Math.random() * Math.PI * 2;
                this.speed = type === 'core' ? Math.random() * 8 + 5 : (type === 'trail' ? Math.random() * 3 + 1 : Math.random() * 6 + 2);
                // é‡åŠ›å’Œè¡°å‡
                this.gravity = 0.05;
                this.alpha = type === 'core' ? 1 : (type === 'trail' ? 0.8 : 0.9);
                this.decay = type === 'core' ? 0.015 : (type === 'trail' ? 0.02 : 0.01);
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
            }
            update() {
                // åŠ å…¥é‡åŠ›
                this.vy += this.gravity;
                this.x += this.vx;
                this.y += this.vy;
                // é€Ÿåº¦è¡°å‡
                this.vx *= 0.98;
                this.vy *= 0.98;
                // é€æ˜åº¦è¡°å‡
                this.alpha -= this.decay;
                // å°ºå¯¸ç¼©å°
                this.size *= 0.98;
            }
            draw() {
                if (this.alpha <= 0) return;
                ctx.save();
                ctx.globalAlpha = this.alpha;
                // æ ¸å¿ƒç²’å­åŠ å…‰æ™•
                if (this.type === 'core') {
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = this.color;
                }
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }
        }

        // ç”ŸæˆçƒŸèŠ±ï¼ˆå¤§å¹…æé«˜ç²’å­å¯†åº¦ï¼‰
        function createFirework(x, y) {
            // é™åˆ¶çƒŸèŠ±æ•°é‡ï¼Œé¿å…æ€§èƒ½å¡é¡¿
            if (fireworkParticles.length > config.fireworks.maxCount * 15) return;
            
            // æ’­æ”¾çƒŸèŠ±éŸ³æ•ˆï¼ˆæ¯æ¬¡å¿ƒè·³è§¦å‘ä¸€æ¬¡ï¼‰
            fireworkAudio.currentTime = 0; // é‡ç½®æ’­æ”¾ä½ç½®
            fireworkAudio.play().catch(err => console.log("çƒŸèŠ±éŸ³æ•ˆæ’­æ”¾å¤±è´¥ï¼š", err));
            
            // 1. çƒŸèŠ±æ ¸å¿ƒï¼ˆæ•°é‡ç¿»å€ï¼‰
            for (let i = 0; i < 30; i++) { // åŸ15 â†’ 30
                fireworkParticles.push(new FireworkParticle(x, y, 'core'));
            }
            // 2. æ™®é€šç‚¸è£‚ç²’å­ï¼ˆå¤§å¹…å¢åŠ ï¼‰
            for (let i = 0; i < 120; i++) { // åŸ80 â†’ 120
                fireworkParticles.push(new FireworkParticle(x, y, 'normal'));
            }
            // 3. æ‹–å°¾ç²’å­ï¼ˆæ•°é‡ç¿»å€ï¼‰
            for (let i = 0; i < 80; i++) { // åŸ40 â†’ 80
                fireworkParticles.push(new FireworkParticle(x, y, 'trail'));
            }
            // éšæœºåœ¨ç”»å¸ƒå…¶ä»–ä½ç½®ç”Ÿæˆæ¬¡çº§çƒŸèŠ±ï¼ˆæ‰©å¤§éœ‡æ’¼èŒƒå›´ï¼Œæ•°é‡å¢åŠ ï¼‰
            const secondaryCount = Math.floor(Math.random() * 5 + 3); // åŸ3+2 â†’ 5+3
            for (let i = 0; i < secondaryCount; i++) {
                const sx = Math.random() * canvasWidth;
                const sy = Math.random() * canvasHeight;
                for (let j = 0; j < 50; j++) { // åŸ30 â†’ 50
                    fireworkParticles.push(new FireworkParticle(sx, sy, j % 3 === 0 ? 'trail' : 'normal'));
                }
            }
        }

        // 3. çˆ±å¿ƒç²’å­ï¼ˆç‚¹ç¼€ï¼Œæ•°é‡å¢åŠ ï¼‰
        let heartParticles = [];
        class HeartParticle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 2 + 1;
                this.color = config.colors.tertiary;
                this.vx = Math.random() * 4 - 2;
                this.vy = Math.random() * 4 - 2;
                this.alpha = 1;
                this.decay = Math.random() * 0.01 + 0.005;
                // æ—‹è½¬æ•ˆæœ
                this.rotation = Math.random() * Math.PI * 2;
                this.rotateSpeed = Math.random() * 0.1 - 0.05;
            }
            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.alpha -= this.decay;
                this.rotation += this.rotateSpeed;
                // ç¼“åŠ¨æ•ˆæœ
                this.vx *= 0.97;
                this.vy *= 0.97;
            }
            draw() {
                if (this.alpha <= 0) return;
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);
                // å°çˆ±å¿ƒå½¢çŠ¶
                ctx.beginPath();
                for (let t = 0; t < Math.PI * 2; t += 0.1) {
                    const x = 4 * Math.pow(Math.sin(t), 3);
                    const y = -(3 * Math.cos(t) - Math.cos(3*t));
                    ctx.lineTo(x, y);
                }
                ctx.closePath();
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }
        }

        // 4. çˆ±å¿ƒç»˜åˆ¶ï¼ˆé«˜çº§æ¸å˜+å“‘å…‰è´¨æ„Ÿï¼‰
        let mouseX = canvasWidth / 2;
        let mouseY = canvasHeight / 2;
        let heartScale = config.heart.baseScale;
        let heartPulse = 0;
        let lastFireworkTime = 0; // é™åˆ¶çƒŸèŠ±éŸ³æ•ˆè§¦å‘é¢‘ç‡

        window.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });

        function drawHeart() {
            ctx.save();
            // çµåŠ¨åç§»+ç¼“åŠ¨è·Ÿéš
            const offsetX = Math.sin(Date.now() / 1500) * 8;
            const offsetY = Math.cos(Date.now() / 1500) * 8;
            const targetX = mouseX + offsetX;
            const targetY = mouseY + offsetY;
            // å¿ƒè·³ç¼©æ”¾ï¼ˆæ›´è‡ªç„¶çš„æ›²çº¿ï¼‰
            heartPulse += config.heart.pulseSpeed;
            heartScale = config.heart.baseScale + (config.heart.maxScale - config.heart.baseScale) * Math.pow(Math.sin(heartPulse), 2);

            ctx.translate(targetX, targetY);
            ctx.scale(heartScale, heartScale);

            // é«˜çº§å“‘å…‰æ¸å˜ï¼ˆä½é¥±å’Œ+æ˜æš—è¿‡æ¸¡ï¼‰
            const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, 80);
            gradient.addColorStop(0, config.colors.tertiary);
            gradient.addColorStop(0.6, config.colors.primary);
            gradient.addColorStop(1, config.colors.secondary);

            // ç»˜åˆ¶çˆ±å¿ƒï¼ˆæ›´é¥±æ»¡çš„å½¢çŠ¶ï¼‰
            ctx.beginPath();
            for (let t = 0; t < Math.PI * 2; t += 0.01) {
                const x = 16 * Math.pow(Math.sin(t), 3);
                const y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
                ctx.lineTo(x * 4, y * 4);
            }
            ctx.closePath();

            // å“‘å…‰å¡«å……+ç»†æè¾¹ï¼ˆé«˜çº§è´¨æ„Ÿï¼‰
            ctx.fillStyle = gradient;
            ctx.fill();
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 1.2;
            ctx.stroke();

            ctx.restore();

            // å¿ƒè·³å³°å€¼è§¦å‘çƒŸèŠ±å’Œçˆ±å¿ƒç²’å­ï¼ˆé™åˆ¶é¢‘ç‡ï¼Œé¿å…éŸ³æ•ˆåˆ·å±ï¼‰
            const now = Date.now();
            if (heartScale > config.heart.maxScale - 0.02 && now - lastFireworkTime > 800) {
                lastFireworkTime = now;
                // ç”Ÿæˆçˆ±å¿ƒç²’å­ï¼ˆæ•°é‡å¢åŠ ï¼‰
                const hCount = Math.floor(Math.random() * 25 + 15); // åŸ15+8 â†’ 25+15
                for (let i = 0; i < hCount; i++) {
                    heartParticles.push(new HeartParticle(targetX + (Math.random() - 0.5) * 120, targetY + (Math.random() - 0.5) * 120));
                }
                // ç”Ÿæˆå…¨å±çƒŸèŠ±
                createFirework(targetX, targetY);
            }
        }

        // 5. ä¸»åŠ¨ç”»å¾ªç¯
        function animate() {
            requestAnimationFrame(animate);

            // åŠé€æ˜å åŠ ï¼ˆæ‹–å½±æ•ˆæœï¼‰
            ctx.fillStyle = 'rgba(10, 10, 18, 0.15)';
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);

            // æ›´æ–°ç»˜åˆ¶æ˜Ÿç©ºç²’å­ï¼ˆæ‰“åº•ï¼‰
            starParticles.forEach(star => {
                star.update();
                star.draw();
            });

            // æ›´æ–°ç»˜åˆ¶çƒŸèŠ±ç²’å­
            fireworkParticles = fireworkParticles.filter(p => p.alpha > 0 && p.size > 0.1);
            fireworkParticles.forEach(particle => {
                particle.update();
                particle.draw();
            });

            // æ›´æ–°ç»˜åˆ¶çˆ±å¿ƒç²’å­
            heartParticles = heartParticles.filter(p => p.alpha > 0);
            heartParticles.forEach(particle => {
                particle.update();
                particle.draw();
            });

            // ç»˜åˆ¶çˆ±å¿ƒ
            drawHeart();
        }

        // å¯åŠ¨åŠ¨ç”»
        animate();
    </script>
</body>
</html>